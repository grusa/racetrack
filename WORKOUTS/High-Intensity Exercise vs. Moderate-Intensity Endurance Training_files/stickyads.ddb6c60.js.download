(window.webpackJsonp=window.webpackJsonp||[]).push([["modules/stickyads"],{"25198250de57e9ac2bf1":function(t,e,n){"use strict";n.r(e),n.d(e,"getScrollTop",function(){return f}),n.d(e,"hasLeadVideo",function(){return g}),n.d(e,"Ad",function(){return y}),n.d(e,"StickyAds",function(){return p});var o=n("8d0684f10c3cea737a13"),r=n("891a19eb7d3552f95f46"),s=n("654adc4d2d3e5dbaee18");function l(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}var d=[".article-breaker-ad:not(.mobile-breaker-ad)",".listicle-slide-list-ad"].join(","),u=".content-rail",h="".concat(u,", .right-rail-ad"),f=function(){return window.pageYOffset},g=function(){return null!==document.querySelector(".content-lede-video [data-sticky=true]")},y=function(){function e(t){a(this,e),this.el=t,this.storeParent(),this.fixedToTop=!0,this.fixedToBottom=!1}return c(e,[{key:"fix",value:function(){var t=this.el.getBoundingClientRect().left,e=document.body.clientWidth-(this.el.offsetWidth+t),n=["position: fixed","top: ".concat(90,"px"),"right: ".concat(e,"px"),"width: auto"].join(";");this.storeParent(),this.el.style.cssText=n,this.fixedToTop=!1,this.fixedToBottom=!1}},{key:"fixToBottom",value:function(t){var e=t-(f()+this.parent.getBoundingClientRect().top);this.el.style.cssText="position: absolute; top: ".concat(e,"px; right:40px;"),this.fixedToBottom=!0}},{key:"unfix",value:function(){this.el.style.cssText="",this.fixedToTop=!0}},{key:"storeParent",value:function(){this.parent=this.el.offsetParent}}]),e}(),p=function(){function i(t){var e=this;a(this,i),this.ads=[],this.el=t,this.fixed=!1,this.scrollTracking=!1,this.lastScrollY=f(),this.logger=new r.a("StickyAds"),this.enabled=!0,this.registerAds(this.el.querySelectorAll(h)),this.observer=Object(s.v)(this.el,this.handleMutation.bind(this),{childList:!0,subtree:!0}),window.addEventListener("glimmer.sticky",function(){return e.handleStickyVideo()}),window.addEventListener("glimmer.unsticky",function(){return e.handleUnstickyVideo()}),window.addEventListener("app.nextContentLoaded",function(){return e.handleNextContentLoaded()}),this.startScrollTracking()}return c(i,null,[{key:"setup",value:function(t){var e=0<arguments.length&&void 0!==t?t:{},n=document.querySelector(e.selector||".content-container");return!n||Modernizr.mobile||Modernizr.tablet||g()?null:new i(n)}}]),c(i,[{key:"handleMutation",value:function(t){var e=l(t.addedNodes).filter(function(t){return t instanceof Element&&t.matches(h)});e.length&&this.registerAds(e)}},{key:"handleScroll",value:function(t){var e=t>this.lastScrollY?"down":"up";if(this.lastScrollY=t,this.fixed){var n=this.fixed.el;if("down"==e){var i=this.getLowerBoundary(n);i<=t+90&&(this.fixed.fixToBottom(i),this.fixed=null)}else t+90<=this.getUpperBoundary(n)&&(this.fixed.unfix(),this.fixed=null)}else this.checkForAdsToFix(e)}},{key:"handleStickyVideo",value:function(){this.stopScrollTracking();for(var t=0,e=this.ads.length;t<e;t+=1)this.ads[t].unfix();this.fixed=null}},{key:"handleUnstickyVideo",value:function(){this.startScrollTracking()}},{key:"handleNextContentLoaded",value:function(){this.enabled=!1,this.stopScrollTracking();for(var t=0,e=this.ads.length;t<e;t+=1)this.ads[t].unfix();this.fixed=null}},{key:"startScrollTracking",value:function(){this.enabled&&(o.a.on("scroll",this.handleScroll.bind(this),"sticky-ads"),this.scrollTracking=!0)}},{key:"stopScrollTracking",value:function(){o.a.off("scroll","sticky-ads"),this.scrollTracking=!1}},{key:"checkForAdsToFix",value:function(t){for(var e=0,n=this.ads.length;e<n;e+=1){var i=this.ads[e],o=i.el,r=o.getBoundingClientRect(),s=r.bottom,l=r.top;if(0<s&&l<window.innerHeight){if("down"===t?l<=90&&!i.fixedToBottom&&this.getLowerBoundary(o)>this.getUpperBoundary(o):90<=l&&!i.fixedToTop)return i.fix(),void(this.fixed=i)}}}},{key:"registerAds",value:function(t){var e=this;l(t).forEach(function(t){return e.ads.push(new y(t))}),this.logger.log("regiserted new ads",t,this.ads),this.ads.sort(function(t,e){var n=t.el.getBoundingClientRect().top,i=e.el.getBoundingClientRect().top;return i<n?1:n<i?-1:0})}},{key:"getLowerBoundary",value:function(t){var e,n=t.matches(u)?this.el.querySelector(d):Object(s.n)(t,d);return e=n?n.getBoundingClientRect().top:this.el.getBoundingClientRect().bottom,(e+=f())-t.getBoundingClientRect().height-window.innerHeight}},{key:"getUpperBoundary",value:function(t){var e,n=Object(s.q)(t,d);return e=n?n.getBoundingClientRect().bottom+20:this.el.getBoundingClientRect().top,f()+e}}]),i}()}}]);
//# sourceMappingURL=stickyads.ddb6c60.js.map